# Core Functionality


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## Post class

------------------------------------------------------------------------

<a
href="https://github.com/decherd/fh_posts/blob/main/fh_posts/core.py#L31"
target="_blank" style="float:right; font-size:smaller">source</a>

### Post

>  Post (path:pathlib.Path, metadata:fastcore.basics.AttrDict, slug:str)

*Represents a blog post with its metadata and content. This class
provides methods to render the post content with optional code execution
and formatting options.*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>Path</td>
<td>The path to the post</td>
</tr>
<tr>
<td>metadata</td>
<td>AttrDict</td>
<td>The metadata for the post</td>
</tr>
<tr>
<td>slug</td>
<td>str</td>
<td>The slug for the post</td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/decherd/fh_posts/blob/main/fh_posts/core.py#L53"
target="_blank" style="float:right; font-size:smaller">source</a>

### Post.render

>  Post.render (open_links_new_window:bool=False, live_label:bool=True)

*Render the post content with code execution as specified by tags.*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>open_links_new_window</td>
<td>bool</td>
<td>False</td>
<td>Whether to open links in a new window</td>
</tr>
<tr>
<td>live_label</td>
<td>bool</td>
<td>True</td>
<td>Whether to show the live label</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>NotStr</strong></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

## Front Matter

Front matter is the metadata that is stored in the file before the
content. In a notebook, it is the YAML frontmatter that is stored in the
first cell as a raw cell. In a markdown file, it is the YAML frontmatter
that is stored in the file before the content.

The
[`extract_frontmatter`](https://decherd.github.io/fh_posts/core.html#extract_frontmatter)
function is used to extract the frontmatter from a file.

The
[`extract_notebook_frontmatter`](https://decherd.github.io/fh_posts/core.html#extract_notebook_frontmatter)
function is used to extract the frontmatter from a notebook.

Sample front matter:

    ---
    title: WorldTest
    summary: A test of a .md file
    date: February 25, 2025
    tags:
      - python
      - fasthtml
      - monsterui
    ---

------------------------------------------------------------------------

<a
href="https://github.com/decherd/fh_posts/blob/main/fh_posts/core.py#L70"
target="_blank" style="float:right; font-size:smaller">source</a>

### extract_frontmatter

>  extract_frontmatter (file_path:pathlib.Path)

*Extract YAML frontmatter from a Markdown file.*

<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 38%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>file_path</td>
<td>Path</td>
<td>The path to the file to extract the frontmatter from</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>AttrDict</strong></td>
<td></td>
</tr>
</tbody>
</table>

``` python
md_path = Path('posts/md_test.md')
md_metadata = extract_frontmatter(md_path)
md_metadata
```

``` json
{ 'date': 'February 25, 2025',
  'summary': 'A test of a .md file',
  'tags': ['python', 'fasthtml', 'monsterui'],
  'title': 'MD Test'}
```

Because
[`extract_frontmatter`](https://decherd.github.io/fh_posts/core.html#extract_frontmatter)
returns an `AttrDict`, you can access the metadata using keys or
attributes.

``` python
test_eq(md_metadata['date'], 'February 25, 2025')
test_eq(md_metadata.date, 'February 25, 2025')
assert isinstance(md_metadata.tags, list)
```

------------------------------------------------------------------------

<a
href="https://github.com/decherd/fh_posts/blob/main/fh_posts/core.py#L93"
target="_blank" style="float:right; font-size:smaller">source</a>

### extract_notebook_frontmatter

>  extract_notebook_frontmatter (file_path:pathlib.Path)

*Extract YAML frontmatter from a Jupyter Notebook file.*

<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 38%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>file_path</td>
<td>Path</td>
<td>The path to the notebook to extract the frontmatter from</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>AttrDict</strong></td>
<td></td>
</tr>
</tbody>
</table>

``` python
nb_path = Path('posts/nb_test.ipynb')
nb_metadata = extract_notebook_frontmatter(nb_path)
nb_metadata
```

``` json
{ 'date': 'February 24, 2025',
  'summary': 'A test of an .ipynb file',
  'tags': ['python', 'fasthtml', 'monsterui'],
  'title': 'NB Test'}
```

``` python
test_eq(nb_metadata['title'], 'NB Test')
test_eq(nb_metadata.summary, 'A test of an .ipynb file')
```

Once we have the metadata, we can create a
[`Post`](https://decherd.github.io/fh_posts/core.html#post) object and
test that we can access the metadata using keys or attributes.

``` python
md_post = Post(md_path, md_metadata, 'world')
nb_post = Post(nb_path, nb_metadata, 'hello')
test_eq(md_post['date'], 'February 25, 2025')
test_eq(nb_post.date, 'February 24, 2025')
assert isinstance(md_post.tags, list)
```

------------------------------------------------------------------------

<a
href="https://github.com/decherd/fh_posts/blob/main/fh_posts/core.py#L115"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_post_date

>  get_post_date (post, date_format='%B %d, %Y')

*Extract date from post for sorting.*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>post</td>
<td></td>
<td></td>
<td>The post to get the date from</td>
</tr>
<tr>
<td>date_format</td>
<td>str</td>
<td>%B %d, %Y</td>
<td>The format string for the date i.e. “January 01, 2025”</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>datetime</strong></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

``` python
test_eq(get_post_date(md_post), datetime.strptime('February 25, 2025', "%B %d, %Y"))
test_eq(get_post_date(nb_post), datetime.strptime('February 24, 2025', "%B %d, %Y"))
```

------------------------------------------------------------------------

<a
href="https://github.com/decherd/fh_posts/blob/main/fh_posts/core.py#L129"
target="_blank" style="float:right; font-size:smaller">source</a>

### load_posts

>  load_posts (path:str|pathlib.Path, date_format:str='%B %d, %Y')

*Load all posts from the specified directory. Extracts frontmatter from
markdown files and notebooks with
[`extract_frontmatter`](https://decherd.github.io/fh_posts/core.html#extract_frontmatter)
and
[`extract_notebook_frontmatter`](https://decherd.github.io/fh_posts/core.html#extract_notebook_frontmatter)
respectively. Specify optional date format string for
[`get_post_date`](https://decherd.github.io/fh_posts/core.html#get_post_date)
to sort posts by date.*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>str | pathlib.Path</td>
<td></td>
<td>The path to the directory containing the posts</td>
</tr>
<tr>
<td>date_format</td>
<td>str</td>
<td>%B %d, %Y</td>
<td>The format string for the date i.e. “January 01, 2025”</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>List</strong></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

Posts are loaded and sorted by date in reverse order so newest post come
first.

``` python
posts = load_posts('posts')
posts
```

    [Post(slug='md_test', title='MD Test', path='posts/md_test.md'),
     Post(slug='nb_test', title='NB Test', path='posts/nb_test.ipynb')]

``` python
print([post.date for post in posts])
```

    ['February 25, 2025', 'February 24, 2025']

``` python
test_eq(posts[0].date, 'February 25, 2025')
```

## Helper Functions

------------------------------------------------------------------------

<a
href="https://github.com/decherd/fh_posts/blob/main/fh_posts/core.py#L162"
target="_blank" style="float:right; font-size:smaller">source</a>

### parse_tag

>  parse_tag (tag_str:str)

*Parse a tag string into a dict of tag properties e.g.,
‘python:run:hide-in’.*

``` python
tags = 'python:run:hide'
processed_tags = parse_tag(tags)
processed_tags
```

    {'run': True, 'hide_in': True, 'hide_out': True, 'hide_call': False}

[`parse_tag`](https://decherd.github.io/fh_posts/core.html#parse_tag)
parses the tag that is used to control the execution of the code in the
notebook and markdown files. The tag is a string that contains the tag
name and optional properties separated by colons. In markdown files the
tag follows the triple backticks that start the code block and in
notebooks the tag is the first line of the code block and is prefixed
with `#|`. The properties are:

`run`: Whether to run the code

`hide_in`: Whether to hide the input code

`hide_out`: Whether to hide the output

`hide_call`: Whether to hide the final call line

The tag is used in the markdown and notebook files to control the
execution of the code.

------------------------------------------------------------------------

<a
href="https://github.com/decherd/fh_posts/blob/main/fh_posts/core.py#L200"
target="_blank" style="float:right; font-size:smaller">source</a>

### execute_code

>  execute_code (code:str, namespace:Optional[Dict]=None)

*Execute Python code and return the execution result.*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>str</td>
<td></td>
<td>The code to execute</td>
</tr>
<tr>
<td>namespace</td>
<td>Optional</td>
<td>None</td>
<td>Optional namespace to use for execution</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>Dict</strong></td>
<td></td>
<td><strong>Returns a dict with keys: output (captured stdout), error
(captured stderr), result (last expression result), namespace (updated
namespace)</strong></td>
</tr>
</tbody>
</table>

``` python
code_samp = """
def greeting(name):
    print(f"Debug: Function called with name: {name}")
    return f"Hello, {name}!"

greeting("Alice")"""
```

``` python
test_eq(execute_code(code_samp)['result'], "Hello, Alice!")
assert execute_code(code_samp)['output'].startswith("Debug:")
```

The `output` is captured from the stdout and stderr streams and would be
what is printed to the console. The `result` is the value of the last
expression in the code. Note that in a notebook environment the `output`
can be captured twice but this doesn’t happen at run time.

------------------------------------------------------------------------

<a
href="https://github.com/decherd/fh_posts/blob/main/fh_posts/core.py#L257"
target="_blank" style="float:right; font-size:smaller">source</a>

### process_code_block

>  process_code_block (tag_props:Dict[str,bool], code:str,
>                          namespace:Optional[Dict]=None)

*Process a code block based on its tag properties.*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>tag_props</td>
<td>Dict</td>
<td></td>
<td>Dict of tag properties</td>
</tr>
<tr>
<td>code</td>
<td>str</td>
<td></td>
<td>Python code to execute</td>
</tr>
<tr>
<td>namespace</td>
<td>Optional</td>
<td>None</td>
<td>Optional namespace to use for execution</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>Dict</strong></td>
<td></td>
<td><strong>Returns a dict with keys: show_code, show_output, code_html,
output_html, namespace</strong></td>
</tr>
</tbody>
</table>

``` python
code_block_dict =  process_code_block(parse_tag('python:run:hide'), code_samp)
test_eq(code_block_dict['show_code'], False)
test_eq(code_block_dict['show_output'], False)
test_eq(code_block_dict['code_html'], '')
```

------------------------------------------------------------------------

<a
href="https://github.com/decherd/fh_posts/blob/main/fh_posts/core.py#L322"
target="_blank" style="float:right; font-size:smaller">source</a>

### render_markdown_post

>  render_markdown_post (post:__main__.Post,
>                            open_links_new_window:bool=False,
>                            live_label:bool=True)

*Render a Markdown post with code execution.*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>post</td>
<td>Post</td>
<td></td>
<td>The post to render</td>
</tr>
<tr>
<td>open_links_new_window</td>
<td>bool</td>
<td>False</td>
<td></td>
</tr>
<tr>
<td>live_label</td>
<td>bool</td>
<td>True</td>
<td></td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>NotStr</strong></td>
<td></td>
<td><strong>The rendered HTML in a NotStr object (FastHTML
object)</strong></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/decherd/fh_posts/blob/main/fh_posts/core.py#L395"
target="_blank" style="float:right; font-size:smaller">source</a>

### render_notebook_post

>  render_notebook_post (post:__main__.Post,
>                            open_links_new_window:bool=False,
>                            live_label:bool=True)

*Render a Jupyter Notebook post with code execution.*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>post</td>
<td>Post</td>
<td></td>
<td>The post to render</td>
</tr>
<tr>
<td>open_links_new_window</td>
<td>bool</td>
<td>False</td>
<td></td>
</tr>
<tr>
<td>live_label</td>
<td>bool</td>
<td>True</td>
<td></td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>NotStr</strong></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
